# aemdesign-aem-core

[![pipeline status](https://gitlab.com/aem.design/aemdesign-aem-core/badges/develop/pipeline.svg)](https://gitlab.com/aem.design/aemdesign-aem-core/commits/develop)
[![Quality Gate Status](https://sonarcloud.io/api/project_badges/measure?project=aemdesign%3Aaemdesign-aem-core&metric=alert_status)](https://sonarcloud.io/dashboard?id=aemdesign%3Aaemdesign-aem-core)
[![build_status](https://travis-ci.org/aem-design/aemdesign-aem-core.svg?branch=master)](https://travis-ci.org/aem-design/aemdesign-aem-core)

A set of standardized components for AEM 6.4+ that can be used to speed up development of websites.

## Documentation

* [AEM.Design Blog](https://aem.design)


## Development
If you're curious about how the next generation of components looks like, a tech preview is made available in the
[`development`](https://github.com/aem-design/aemdesign-aem-core/tree/development) branch.

## Contributing

Contributions are welcome! Read the [Contributing Guide](CONTRIBUTING.md) for more information.

## Available Components

Detailed table of component can be found here [Component List](https://github.com/aem-design/aemdesign-aem-core/wiki/Component-List)

| Category  	| Component                                                                                                                           	|
|-----------	|-------------------------------------------------------------------------------------------------------------------------------------	|
| Lists     	| [Asset List](src/main/content/jcr_root/apps/aemdesign/components/lists/assetlist/v2/assetlist)                                      	|
| Lists     	| [List Nav](src/main/content/jcr_root/apps/aemdesign/components/lists/listnav/v2/listnav)                                            	|
| Lists     	| [Search Results List](src/main/content/jcr_root/apps/aemdesign/components/lists/searchlist/v2/searchlist)                           	|
| Lists     	| [Tag List](src/main/content/jcr_root/apps/aemdesign/components/lists/taglist/v2/taglist)                                            	|
| Lists     	| [List](src/main/content/jcr_root/apps/aemdesign/components/lists/list/v2/list)                                                      	|
| Lists     	| [Lang Nav](src/main/content/jcr_root/apps/aemdesign/components/lists/langnav/v2/langnav)                                            	|
| Lists     	| [Nav List](src/main/content/jcr_root/apps/aemdesign/components/lists/navlist/v2/navlist)                                            	|
| Layout    	| [Content Block Menu](src/main/content/jcr_root/apps/aemdesign/components/layout/contentblockmenu/v2/contentblockmenu)               	|
| Layout    	| [Nav Bar](src/main/content/jcr_root/apps/aemdesign/components/layout/navbar/v2/navbar)                                              	|
| Layout    	| [Content Block](src/main/content/jcr_root/apps/aemdesign/components/layout/contentblock/v2/contentblock)                            	|
| Layout    	| [Footer](src/main/content/jcr_root/apps/aemdesign/components/layout/footer/v2/footer)                                               	|
| Layout    	| [Content Tabs](src/main/content/jcr_root/apps/aemdesign/components/layout/contenttabs/v2/contenttabs)                               	|
| Layout    	| [Article](src/main/content/jcr_root/apps/aemdesign/components/layout/article/v2/article)                                            	|
| Layout    	| [Breadcrumb](src/main/content/jcr_root/apps/aemdesign/components/layout/breadcrumb/v2/breadcrumb)                                   	|
| Layout    	| [Aside](src/main/content/jcr_root/apps/aemdesign/components/layout/aside/v2/aside)                                                  	|
| Layout    	| [Header](src/main/content/jcr_root/apps/aemdesign/components/layout/header/v2/header)                                               	|
| Details   	| [Location Details](src/main/content/jcr_root/apps/aemdesign/components/details/location-details/v2/location-details)                	|
| Details   	| [Event Details](src/main/content/jcr_root/apps/aemdesign/components/details/event-details/v2/event-details)                         	|
| Details   	| [Contact Details](src/main/content/jcr_root/apps/aemdesign/components/details/contact-details/v2/contact-details)                   	|
| Details   	| [News Details](src/main/content/jcr_root/apps/aemdesign/components/details/news-details/v2/news-details)                            	|
| Details   	| [Page Details](src/main/content/jcr_root/apps/aemdesign/components/details/page-details/v2/page-details)                            	|
| Content   	| [Page Tags](src/main/content/jcr_root/apps/aemdesign/components/content/pagetags/v2/pagetags)                                       	|
| Content   	| [Tool Tip](src/main/content/jcr_root/apps/aemdesign/components/content/tooltip/v2/tooltip)                                          	|
| Content   	| [Page Title](src/main/content/jcr_root/apps/aemdesign/components/content/pagetitle/v2/pagetitle)                                    	|
| Content   	| [Embed Source](src/main/content/jcr_root/apps/aemdesign/components/content/embedsource/v2/embedsource)                              	|
| Content   	| [Link](src/main/content/jcr_root/apps/aemdesign/components/content/link/v2/link)                                                    	|
| Content   	| [File Download Link](src/main/content/jcr_root/apps/aemdesign/components/content/download/v2/download)                              	|
| Content   	| [Table](src/main/content/jcr_root/apps/aemdesign/components/content/table/v2/table)                                                 	|
| Content   	| [Page Date](src/main/content/jcr_root/apps/aemdesign/components/content/pagedate/v2/pagedate)                                       	|
| Content   	| [Rich Text](src/main/content/jcr_root/apps/aemdesign/components/content/text/v2/text)                                               	|
| Content   	| [External](src/main/content/jcr_root/apps/aemdesign/components/content/external/v2/external)                                        	|
| Content   	| [Page Author](src/main/content/jcr_root/apps/aemdesign/components/content/pageauthor/v2/pageauthor)                                 	|
| Content   	| [Page Description](src/main/content/jcr_root/apps/aemdesign/components/content/pagedescription/v2/pagedescription)                  	|
| Content   	| [Content Reference](src/main/content/jcr_root/apps/aemdesign/components/content/reference/v2/reference)                             	|
| Common    	| [Static Content Include](src/main/content/jcr_root/apps/aemdesign/components/common/staticinclude/v2/staticinclude)                 	|
| Common    	| [Redirection Notification](src/main/content/jcr_root/apps/aemdesign/components/common/redirectnotification/v2/redirectnotification) 	|
| Common        | [Timing Component](src/main/content/jcr_root/apps/aemdesign/components/common/timing/v2/timing)                                     	|
| Widgets   	| [Online Media](src/main/content/jcr_root/apps/aemdesign/components/widgets/onlinemedia/v2/onlinemedia)                              	|
| Widgets   	| [Search Box](src/main/content/jcr_root/apps/aemdesign/components/widgets/search/v2/search)                                          	|
| Widgets   	| [Addthis Button](src/main/content/jcr_root/apps/aemdesign/components/widgets/addthis/sharebutton/v2/sharebutton)                    	|
| Analytics 	| [Analytics Data Layer](src/main/content/jcr_root/apps/aemdesign/components/analytics/datalayer/v2/datalayer)                        	|
| Media     	| [Video](src/main/content/jcr_root/apps/aemdesign/components/media/video/v2/video)                                                   	|
| Media     	| [Image](src/main/content/jcr_root/apps/aemdesign/components/media/image/v2/image)                                                   	|
| Media     	| [Audio](src/main/content/jcr_root/apps/aemdesign/components/media/audio/v2/audio)                                                   	|

## Component Versioning

The components' versioning scheme is documented on the [AEM Core WCM Components' versioning policies](https://github.com/adobe/aem-core-wcm-components/wiki/Versioning-policies) wiki page.

## System Requirements

The latest version of the Core Components, require the below system requirements:

| AEM Version   | [2.0.0](https://github.com/aem-design/aemdesign-aem-core/tag/2.0.0) |
| -----         | ---   |
| 6.4           | yes   |
| 6.5           | yes   |

## Installation

To install everything, excluding examples, the [released aggregate package `aemdesign-aem-core-deploy`](https://github.com/aem-design/aemdesign-aem-core/releases) can be installed via the AEM Package Manager.

For more information about the Package Manager please have a look at [How to Work With Packages](https://helpx.adobe.com/experience-manager/6-4/sites/administering/using/package-manager.html) documentation page.

### Package Dependencies

Following packages are dependencies and should be installed on your AEM instance before installing AEM.Design:

- [ACS Twitter 1.0.0](https://github.com/Adobe-Consulting-Services/com.adobe.acs.bundles.twitter4j/releases/download/com.adobe.acs.bundles.twitter4j-1.0.0/com.adobe.acs.bundles.twitter4j-content-1.0.0.zip)
- [ACS Commons 4.0.0](https://github.com/Adobe-Consulting-Services/acs-aem-commons/releases/download/acs-aem-commons-4.0.0/acs-aem-commons-content-4.0.0.zip)
- [Core Components 2.3.2](https://github.com/adobe/aem-core-wcm-components/releases/download/core.wcm.components.reactor-2.3.2/core.wcm.components.all-2.3.2.zip)
- [Core Components Extension 1.0.12](https://github.com/adobe/aem-core-wcm-components/releases/download/core.wcm.components.reactor-2.3.2/core.wcm.components.extension-1.0.12.zip)
- [Netcentric Access Control Tool 2.3.2](http://repo1.maven.org/maven2/biz/netcentric/cq/tools/accesscontroltool/accesscontroltool-package/2.3.2/accesscontroltool-package-2.3.2.zip)
- [Adobe Vanity URL 1.0.2](https://www.adobeaemcloud.com/content/companies/public/adobe/packages/cq600/component/vanityurls-components/jcr%3acontent/package/file.res/vanityurls-components-1.0.2.zip)


## Build

The project has the following requirements:
* Java SE Development Kit 8 or Java SE Development Kit 11
* Apache Maven 3.3.1 or newer

For ease of build and installation the following profiles are provided:

 * ``deploymentpackage`` - activates packaging of aemdesign-aem-core-deploy
 * ``installdeploymentpackage`` - installs the deploy package/bundle to an existing AEM author instance

You can use helper script for ease of local deployment

* ``deploy-local`` - deploy aemdesign-aem-core-deploy package to your local AEM instance running on port 4502
* ``deploy-local-publish`` - deploy aemdesign-aem-core-deploy package to your local AEM instance running on port 4503

### UberJar

This project relies on the AEM 6.4 cq-quickstart. This is publicly available on https://repo.adobe.com

For more details about the UberJar please head over to the
[How to Build AEM Projects using Apache Maven](https://helpx.adobe.com/experience-manager/6-4/sites/developing/using/ht-projects-maven.html) documentation page.


## Include core components into your own project maven build

To add core components to your project, you will need to add it to your maven build.
The released version of the framework are available on the public maven repository at https://repo1.maven.org/maven2/design/aem/aemdesign-aem-core-deploy/ 

To include the deploy package into your own project's maven build using maven you can add the dependency to your pom.xml like this

 ```
 <dependency>
     <groupId>design.aem</groupId>
     <artifactId>aemdesign-aem-core-deploy</artifactId>
     <type>zip</type>
     <version>2.0.100</version>
 </dependency>
 ```

and then add this subpackage to your sub package section

```
 <subPackage>
     <groupId>design.aem</groupId>
     <artifactId>aemdesign-aem-core-deploy</artifactId>
     <filter>true</filter>
 </subPackage>
```

inside the configuration of the `content-package-maven-plugin`.

# Development Notes

Following section describes some of the development topics

## Release Versions

Release versions are automated and based on Tags and Commit count from Tag using the `git describe` command

To test git versioning run

`git describe`

this will show you generated version message with latest tag and how many commits since tag.

If you get an error:

`fatal: No annotated tags can describe`

create or overwrite an existing tag with a message:

`git tag 1.0 1.0^{} -f -m "initial tag"`

## Version Convention

Version numbers for Git Tags should follow semver format:

 * MAJOR version when you make incompatible API changes,
 * MINOR version when you add functionality in a backwards-compatible manner, and
 * PATCH version is automatically generated based on git commit count from last Tag

Please use MAJOR and MINOR version in Tags, PATCH version will be automatically added as a commit count since the last tag using the git describe.

## Minimal core artifacts required for providing overridable AEM components.
 
`aemdesign-aem-core-deploy` module creates an aem package for deployment which contains:
 * `aemdesign-aem-author`
 * `amedesign-aem-common`
 
`aemdesign-aem-common` module embeds bundles:
 * `aemdesign-aem-services` 
 
## To build
To ensure the project builds correctly locally run:

`mvn -Dvault.useProxy=false -DskipTests -e -U clean package`

## To deploy
To build and deploy the project to your local aem instance (default localhost:4502), in the project root run:

`./deploy-local`

## To create a release
Releases are managed via the maven plugins `versions-maven-plugin` and `maven-scm-plugin`

Version numbers should follow the [SemVer](https://semver.org/) convention.

### The release process
#### Prepare release branch
In preparation for a release, create a new git release branch from the current master snapshot branch:
 1. Create a new release branch.
    * `mvn scm:branch -Dbranch=release/<version> -Dmessage="creating release branch <version>"`
 2. Ensure you are on the new release branch.
    * `git checkout release/<version>`
 3. Update the maven `version` parameter.
    * `mvn versions:set -DnewVersion=<version>`
 4. Check the version number was correctly applied and confirm.
    * `mvn versions:commit -Pdeploymentpackage`
 5. Commit the updated version numbers to the release branch.
    * `mvn scm:checkin -Dmessage="updating version numbers"`

#### Release new version
Once the testing cycle has been completed and all code fixes have been applied to the remote release branch, we create a git tag of our version and deploy the maven `aemdesign-aem-core` artifact to the remote maven repository and merge our release to master branch.
 1. Ensure we are on the release branch for [aemdesign-aem-core](https://gitlab.com/aem.design/aemdesign-aem-core).
 2. Raise a Gitlab Merge Request from the relase branch to master branch, adding the necessary reviewers.
 3. Create the git tag.
    * `mvn scm:tag -Dtag="<version>"`
 4. Deploy the maven release artifacts to the remote maven repository
    * `<ToDo>`
 5. Accept the [aemdesign-aem-core](https://gitlab.com/aem.design/aemdesign-aem-core) Merge Request and delete the release branch.
 6. Update the `Release history` section in this readme with details of the new release.
  
 
## Release history

Please review [Versions](VERSIONS.md) for all version history

