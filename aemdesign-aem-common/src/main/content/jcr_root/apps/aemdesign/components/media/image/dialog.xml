<?xml version="1.0" encoding="UTF-8"?>
<jcr:root xmlns:cq="http://www.day.com/jcr/cq/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0"  xmlns:rep="internal"
          jcr:primaryType="cq:Dialog"
          jcr:mixinTypes="[rep:AccessControllable]"
          description="Image Component"
          selectTabInGroup="function(tabToSelect,tabGroupItems) { AEMDESIGN.dialog.manageTabGroup(this.findByType('tabpanel')[0],tabToSelect,tabGroupItems,true); }"
          selectTab="function(tabToSelect) { AEMDESIGN.dialog.manageTabs(this.findByType('tabpanel')[0],tabToSelect,true); }"
          hideTab="function(tabToHide) { AEMDESIGN.dialog.hideTab(tabToHide, this.findByType('tabpanel')[0]); }"
          includeTab="function(tabToInclude) { AEMDESIGN.dialog.includeTab(tabToInclude, this.findByType('tabpanel')[0]); }"
          title="Image"
          height="490"
          width="600"
          xtype="dialog">
    <items jcr:primaryType="cq:WidgetCollection">
        <tabs jcr:primaryType="cq:TabPanel">
            <items jcr:primaryType="cq:WidgetCollection">
                <imageTab
                        jcr:primaryType="cq:Widget"
                        path="/apps/aemdesign/global/dialog/classic/common/items/imageTab.infinity.json"
                        xtype="cqinclude"/>
                <overrideImageMetadataTab
                        jcr:primaryType="cq:Widget"
                        path="/apps/aemdesign/global/dialog/classic/common/items/overrideImageMetadataTab.infinity.json"
                        xtype="cqinclude"/>
                <layoutTab
                        jcr:primaryType="cq:Widget"
                        title="Layout"
                        name="layoutTab"
                        xtype="panel">
                    <items jcr:primaryType="cq:WidgetCollection">
                        <variant
                                jcr:primaryType="cq:Widget"
                                defaultValue=""
                                value=""
                                allowBlank="{Boolean}true"
                                fieldLabel="Variant"
                                name="./variant"
                                type="select"
                                xtype="selection">
                            <listeners
                                    jcr:primaryType="nt:unstructured"
                                    loadcontent="function(field,record,path){ var selectedTabName = field.getValue(); var item = field.options.filter(function(a){if(a.value==selectedTabName){return a}});  if (item[0]) { if (item[0].selectTab) {  selectedTabName = item[0].selectTab; } };  field.findParentByType('dialog').selectTabInGroup(selectedTabName,field.options); }"
                                    selectionchanged="function(field,value,isChecked){ var selectedTabName = value; var item = field.options.filter(function(a){if(a.value==selectedTabName){return a}}); if (item[0]) { if (item[0].selectTab) {  selectedTabName = item[0].selectTab; } };  field.findParentByType('dialog').selectTabInGroup(selectedTabName,field.options); }"/>
                            <options jcr:primaryType="cq:WidgetCollection">
                                <default
                                        jcr:primaryType="nt:unstructured"
                                        value=""
                                        text="Default"/>
                                <imageOnly
                                        jcr:primaryType="nt:unstructured"
                                        value="imageOnly"
                                        text="Image Only" />
                                <imageCard
                                        jcr:primaryType="nt:unstructured"
                                        value="card"
                                        selectTab="cardConfig"
                                        text="Image Card" />
                                <imageTitleDescription
                                        jcr:primaryType="nt:unstructured"
                                        value="imageTitleDescription"
                                        text="Image with title &amp; description"/>
                            </options>
                        </variant>

                        <imageOption jcr:primaryType="cq:Widget"
                                       fieldLabel="Image Option"
                                       fieldDescription="Image selection options for rendering image"
                                       allowBlank="{Boolean}true"
                                       name="./imageOption"
                                       type="select"
                                       defaultValue=""
                                       value=""
                                       xtype="selection">
                            <listeners
                                    jcr:primaryType="nt:unstructured"
                                    loadcontent="function(field,record,path){ var selectedTabName = field.getValue(); var item = field.options.filter(function(a){if(a.value==selectedTabName){return a}});  if (item[0]) { if (item[0].selectTab) {  selectedTabName = item[0].selectTab; } };  field.findParentByType('dialog').selectTabInGroup(selectedTabName,field.options); }"
                                    selectionchanged="function(field,value,isChecked){ var selectedTabName = value; var item = field.options.filter(function(a){if(a.value==selectedTabName){return a}}); if (item[0]) { if (item[0].selectTab) {  selectedTabName = item[0].selectTab; } };  field.findParentByType('dialog').selectTabInGroup(selectedTabName,field.options); }"/>
                            <options jcr:primaryType="cq:WidgetCollection">
                                <default
                                        jcr:primaryType="nt:unstructured"
                                        value=""
                                        text="Default"/>
                                <generated
                                        jcr:primaryType="nt:unstructured"
                                        value="generated"
                                        selectTab="imageConfig"
                                        text="Generate: generate new image with current image edits" />
                                <rendition
                                        jcr:primaryType="nt:unstructured"
                                        value="rendition"
                                        selectTab="imageConfig"
                                        text="Rendition: pick a suitable image rendition" />
                                <responsive
                                        jcr:primaryType="nt:unstructured"
                                        value="responsive"
                                        selectTab="responsiveConfig"
                                        text="Responsive: use existing renditions"/>
                                <adaptive
                                        jcr:primaryType="nt:unstructured"
                                        value="adaptive"
                                        selectTab="adaptiveConfig"
                                        text="Adaptive: generate new renditions with quality settings for each breakpoint"/>
                            </options>
                        </imageOption>

                        <linkURL
                                jcr:primaryType="cq:Widget"
                                fieldDescription="link to page or external site"
                                fieldLabel="Image Link URL"
                                name="./linkURL"
                                xtype="pathfield"/>

                    </items>
                </layoutTab>
                <imageConfig
                        jcr:primaryType="cq:Panel"
                        title="Image Config"
                        name="imageConfig"
                        xtype="panel">
                    <listeners
                            jcr:primaryType="nt:unstructured"
                            render="function() { this.findParentByType('dialog').hideTab(this); }"/>
                    <items jcr:primaryType="cq:WidgetCollection">

                        <imageDimension
                                jcr:primaryType="cq:Widget"
                                collapsed="{Boolean}false"
                                collapsible="{Boolean}true"
                                fieldDescription="Image size preference"
                                hideLabel="{Boolean}true"
                                title="Image Dimension"
                                xtype="dialogfieldset">
                            <items jcr:primaryType="cq:WidgetCollection">
                                <imageSize
                                        jcr:primaryType="cq:Widget"
                                        fieldLabel="Image Size"
                                        fieldDescription=""
                                        widthParameter="./width"
                                        heightParameter="./height"
                                        xtype="sizefield"/>
                            </items>
                        </imageDimension>

                        <resizingProportions
                                jcr:primaryType="cq:Widget"
                                collapsed="{Boolean}false"
                                collapsible="{Boolean}true"
                                fieldDescription="Resizes the given layer according to the given dimensions. If both width and height are defined a non-proportional resizing is done. if one of the dimensions is missing or 0, a proportional resizing performed. the non-empty dimensions are trimmed to respect the minimal and maximal dimension constraints. for proportional resizing the constraints apply to the recalculated dimensions. when no dimensions are specified, the layer is resized to fit into the constraint dimensions accordingly. if the constraints cannot be applied to the dimensions, eg if no values can be found that match the constraints, the layer is left untouched. "
                                hideLabel="{Boolean}true"
                                title="Resizing Proportions"
                                xtype="dialogfieldset">
                            <items jcr:primaryType="cq:WidgetCollection">
                                <min
                                        jcr:primaryType="cq:Widget"
                                        fieldLabel="Minimal Size"
                                        heightParameter="./minHeight"
                                        widthParameter="./minWidth"
                                        xtype="sizefield"/>
                                <max
                                        jcr:primaryType="cq:Widget"
                                        fieldLabel="Maximal Size"
                                        heightParameter="./maxHeight"
                                        widthParameter="./maxWidth"
                                        xtype="sizefield"/>
                            </items>
                        </resizingProportions>
                    </items>
                </imageConfig>
                <cardConfig
                        jcr:primaryType="cq:Panel"
                        title="Card Config"
                        name="cardConfig"
                        xtype="panel">
                    <listeners
                            jcr:primaryType="nt:unstructured"
                            render="function() { this.findParentByType('dialog').hideTab(this); }"/>
                    <items jcr:primaryType="cq:WidgetCollection">

                        <thumbnailStyle
                                jcr:primaryType="cq:Widget"
                                title="Thumbnail"
                                xtype="dialogfieldset">
                            <items jcr:primaryType="cq:WidgetCollection">
                                <thumbnailSize
                                        jcr:primaryType="cq:Widget"
                                        fieldLabel="Thumbnail Size (w,h)"
                                        fieldDescription="size of image thumbnail visible on the page"
                                        heightParameter="./htmlHeight"
                                        widthParameter="./htmlWidth"
                                        xtype="sizefield"/>
                            </items>
                        </thumbnailStyle>

                        <cardConfig
                                jcr:primaryType="cq:Widget"
                                collapsed="false"
                                collapsible="false"
                                title="Card Config"
                                xtype="dialogfieldset">
                            <items jcr:primaryType="cq:WidgetCollection">
                                <titleType
                                        jcr:primaryType="cq:Widget"
                                        path="/apps/aemdesign/global/dialog/classic/contentblock/dialog/items/basicTab/items/title/items/titleType.infinity.json"
                                        xtype="cqinclude"/>

                            </items>
                        </cardConfig>

                    </items>
                </cardConfig>
                <responsiveConfig
                        jcr:primaryType="cq:Panel"
                        title="Responsive Config"
                        name="responsiveConfig"
                        xtype="panel">
                    <listeners
                            jcr:primaryType="nt:unstructured"
                            render="function() { this.findParentByType('dialog').hideTab(this); }"/>
                    <items jcr:primaryType="cq:WidgetCollection">
                        <responsiveRenditionSize
                                jcr:primaryType="cq:Widget"
                                collapsed="{Boolean}false"
                                collapsible="{Boolean}true"
                                hideLabel="{Boolean}true"
                                title="Responsive Rendition"
                                xtype="dialogfieldset">
                            <items jcr:primaryType="cq:WidgetCollection">

                                <responsiveImageMapping jcr:primaryType="cq:Widget"
                                                        value=""
                                                        fieldDescription="rendition width = media query, &lt;br> &lt;br> ex 48=(min-width: 1px) and (max-width: 100px), this will show rendition of 48px between 1px and 100px device width &lt;br>&lt;br>  ex 1280=(min-width: 478px) will use rendition 1280 starting from width of 487 and up"
                                                        fieldLabel="Rendition Image Mapping"
                                                        name="./renditionImageMapping"
                                                        orderable="{Boolean}true"
                                                        xtype="multifield"/>
                            </items>
                        </responsiveRenditionSize>
                        <renditionPrefix jcr:primaryType="cq:Widget"
                                        fieldLabel="Rendition Prefix"
                                        fieldDescription="Rendition prefix to use as priority for selecting renditions, otherwise best match will be returned"
                                        allowBlank="{Boolean}true"
                                        name="./renditionPrefix"
                                        options="/etc/tags/component-dialog/asset/rendition/prefix.valuelist.json"
                                        type="select"
                                        defaultValue=""
                                        value=""
                                        xtype="selection"/>

                    </items>
                </responsiveConfig>

                <adaptiveConfig
                        jcr:primaryType="cq:Panel"
                        title="Adaptive Config"
                        name="adaptiveConfig"
                        xtype="panel">
                    <listeners
                            jcr:primaryType="nt:unstructured"
                            render="function() { this.findParentByType('dialog').hideTab(this); }"/>
                    <items jcr:primaryType="cq:WidgetCollection">
                        <adaptiveRenditionSize
                                jcr:primaryType="cq:Widget"
                                collapsed="{Boolean}false"
                                collapsible="{Boolean}true"
                                hideLabel="{Boolean}true"
                                title="Responsive Rendition"
                                xtype="dialogfieldset">
                            <items jcr:primaryType="cq:WidgetCollection">

                                <adaptiveImageMapping jcr:primaryType="cq:Widget"
                                                        value=""
                                                        fieldDescription="width.quality.format = media query, &lt;br> &lt;br> ex 480.medium=(min-width: 1px) and (max-width: 533px), this will show rendition of 48px between 1px and 533px device width &lt;br>&lt;br>  ex full=(min-width: 1332px) will create a close to original rendition"
                                                        fieldLabel="Adaptive Image Mapping"
                                                        name="./renditionImageMapping"
                                                        orderable="{Boolean}true"
                                                        xtype="multifield"/>
                            </items>
                        </adaptiveRenditionSize>
                    </items>
                </adaptiveConfig>

                <styleTab
                        jcr:primaryType="cq:Widget"
                        path="/apps/aemdesign/global/dialog/classic/common/items/styleTab.infinity.json"
                        xtype="cqinclude" />
                <accessibilityTab jcr:primaryType="cq:Panel"
                                  path="/apps/aemdesign/global/dialog/classic/common/items/accessibilityTab.infinity.json"
                                  xtype="cqinclude"/>
            </items>
        </tabs>
    </items>
</jcr:root>

